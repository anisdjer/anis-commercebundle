function Anis(d,b){var a=this;a.options=jQuery.extend({},Anis.prototype.options,b||{});a.anis=jQuery(a.template);a.setContent(d);if(null==a.options.title)jQuery(".anis-titlebox",a.anis).remove();else{jQuery(".anis-title",a.anis).append(a.options.title);if(0===a.options.buttons.length&&!a.options.autoclose&&a.options.closeButton){var c=jQuery('<span class="anis-closebtn"></span>');c.bind("click",function(){a.options.onClose();a.hide()});jQuery(".anis-titlebox",this.anis).prepend(c)}null!=a.options.titleClass&&
jQuery(".anis-titlebox",this.anis).addClass(a.options.titleClass)}null!=a.options.width&&jQuery(".anis-box",a.anis).css("width",a.options.width);if(0<a.options.buttons.length)for(c=0;c<a.options.buttons.length;c++){var e=jQuery('<div class="btnbox"><button class="btn '+(a.options.buttons[c]["class"]?a.options.buttons[c]["class"]:"")+'" href="#">'+a.options.buttons[c].label+"</button></div>").data("value",a.options.buttons[c].val);e.bind("click",function(){var b=jQuery.data(this,"value");a.hide(null!=
a.options.callback?function(){a.options.callback(b)}:null)});jQuery(".anis-actions",this.anis).append(e)}else jQuery(".anis-footbox",this.anis).remove();0===a.options.buttons.length&&null==a.options.title&&!a.options.autoclose&&a.options.closeButton&&(c=jQuery('<span class="anis-closebtn"></span>'),c.bind("click",function(){a.options.onClose();a.hide()}),jQuery(".anis-content",this.anis).prepend(c));a.modal=a.options.modal?jQuery('<div class="anis-modal"></div>').css({opacity:a.options.modalOpacity,
width:jQuery(document).width(),height:jQuery(document).height(),"z-index":a.options.zIndex+jQuery(".anis").length}).appendTo(document.body):null;a.options.show&&a.show();jQuery(window).bind("resize",function(){a.resize()});null!=a.options.autoclose&&setTimeout(function(a){a.options.onClose();a.hide()},a.options.autoclose,this);return a}
Anis.prototype={options:{autoclose:null,buttons:[],callback:null,center:!0,closeButton:!0,onClose:function(){},height:"auto",title:null,titleClass:null,modal:!1,modalOpacity:0.2,padding:"10px",show:!0,unload:!0,viewport:{top:"0px",left:"0px"},width:"500px",zIndex:99999},template:'<div class="anis"><div class="anis-box"><div class="anis-wrapper"><div class="anis-titlebox"><span class="anis-title"></span></div><div class="anis-content"></div><div class="anis-footbox"><div class="anis-actions"></div></div></div></div></div>',
content:"<div></div>",visible:!1,setContent:function(d){jQuery(".anis-content",this.anis).css({padding:this.options.padding,height:this.options.height}).empty().append(d)},viewport:function(){return{top:(jQuery(window).height()-this.anis.height())/2+jQuery(window).scrollTop()+"px",left:(jQuery(window).width()-this.anis.width())/2+jQuery(window).scrollLeft()+"px"}},show:function(){this.visible||(this.options.modal&&null!=this.modal&&this.modal.show(),this.anis.appendTo(document.body),this.options.center&&
(this.options.viewport=this.viewport(jQuery(".anis-box",this.anis))),this.anis.css({top:this.options.viewport.top,left:this.options.viewport.left,"z-index":this.options.zIndex+jQuery(".anis").length}).show().animate({opacity:1},300),this.visible=!0)},hide:function(d){if(this.visible){var b=this;this.anis.animate({opacity:0},300,function(){b.options.modal&&null!=b.modal&&b.modal.remove();b.anis.css({display:"none"}).remove();b.visible=!1;d&&d.call();b.options.unload&&b.unload()});return this}},resize:function(){this.options.modal&&
jQuery(".anis-modal").css({width:jQuery(document).width(),height:jQuery(document).height()});this.options.center&&(this.options.viewport=this.viewport(jQuery(".anis-box",this.anis)),this.anis.css({top:this.options.viewport.top,left:this.options.viewport.left}))},toggle:function(){this[this.visible?"hide":"show"]();return this},unload:function(){this.visible&&this.hide();jQuery(window).unbind("resize",function(){this.resize()});this.anis.remove()}};
jQuery.extend(Anis,{alert:function(d,b,a){a=jQuery.extend({closeButton:!1,buttons:[{id:"ok",label:"OK",val:"OK"}],callback:function(){}},a||{},{show:!0,unload:!0,callback:b});return new Anis(d,a)},ask:function(d,b,a){a=jQuery.extend({closeButton:!1,modal:!0,buttons:[{id:"yes",label:"Yes",val:"Y","class":"btn-success"},{id:"no",label:"No",val:"N","class":"btn-danger"}],callback:function(){}},a||{},{show:!0,unload:!0,callback:b});return new Anis(d,a)},img:function(d,b){var a=new Image;jQuery(a).load(function(){var c=
jQuery(window).width()-50,d=jQuery(window).height()-50,c=this.width>c||this.height>d?Math.min(c/this.width,d/this.height):1;jQuery(a).css({width:this.width*c,height:this.height*c});b=jQuery.extend(b||{},{show:!0,unload:!0,closeButton:!0,width:this.width*c,height:this.height*c,padding:0});new Anis(a,b)}).error(function(){console.log("Error loading "+d)}).attr("src",d)},load:function(d,b){b=jQuery.extend(b||{},{show:!0,unload:!0,params:{}});jQuery.ajax({url:d,data:b.params,dataType:"html",cache:!1,
error:function(a,b,d){console.log(a.responseText)},success:function(a){new Anis(a,b)}})}});